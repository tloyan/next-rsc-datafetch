# Fetch dans un React Server Component

### ğŸ’¡ Fetch RSC

## ğŸ“ Tes notes

DÃ©taille ce que tu as appris ici,Â surÂ uneÂ pageÂ [Notion](https://go.mikecodeur.com/course-notes-template)

## Comprendre

Un composant serveur dans `React` (React Server Component) est un type de composant qui s'exÃ©cute cÃ´tÃ© serveur. Il permet de rendre le contenu HTML Ã  l'avance sur le serveur avant de l'envoyer au client. Cela amÃ©liore les performances et le SEO en permettant un rendu plus rapide des pages et une meilleure indexation par les moteurs de recherche. Les composants serveur peuvent accÃ©der directement aux donnÃ©es du serveur, ce qui simplifie la gestion des donnÃ©es et rÃ©duit les requÃªtes client-serveur.

De base dans Next, tout les composants sont des React Serveur Components, sauf sâ€™ils incluent la directive `â€œuse clientâ€`

Le grand avantage des RSC (React Server Component), câ€™est quâ€™il est possible de dÃ©clarer des composants `React` de maniÃ¨re asynchrone, ce qui simplifie la syntaxe.

```tsx
const Page = async () => {
		const data = await fetch('https/...')
		return (
			<>
			{data.map() ...
			</>
		)
	}
```

ğŸ“‘ Le lien vers la doc [https://react.dev/reference/rsc/server-components](https://react.dev/reference/rsc/server-components)

## Exercice

Avant de faire un `fetch` dans un React Server Component, nous allons voir comment nous pouvons utiliser lâ€™api `use` de `React 19`.

ğŸ“‘ Le lien vers la doc [https://react.dev/reference/react/use](https://react.dev/reference/react/use)

```tsx
import { use } from 'react'

function Component() {
  const message = use(Promise)
```

**ğŸ¶ Dans cet exercice, tu vas devoir convertir le code utilisant le `fetch` et `useEffect` en le simplifiant avec `use`.**

Fichiers

- `exercises/post/page.tsx`

## Bonus

### 1. ğŸš€ Transforme ce RCC en RSC

**ğŸ¶** Supprime la directive `â€œuse clientâ€` du fichier pour transformer le RCC en RSC. Cela ne pose pas de problÃ¨me car nous nâ€™utilisons pas de Hook comme `useState` et `useEffect`. Regarde oÃ¹ sont loguÃ©es les datas.

<aside>
ğŸ’¡ ExÃ©cute un CURL et constate quâ€™en client comme en serveur, les donnÃ©es sont dÃ©jÃ  lÃ  car `use`  sâ€™exÃ©cute des 2 cÃ´tÃ©s.

</aside>

Fichiers

- `exercises/post/page.tsx`

### 2. ğŸš€ Fetch directement dans un RSC

Les RSC permettent dâ€™utiliser du code `async` dans les composants. Comme `use` nâ€™est pas recommandÃ© pour `fetch` des datas dans un RSC, nous pouvons utiliser `fetch` directement dans les composants.

[https://react.dev/reference/react/use](https://react.dev/reference/react/use)

```tsx
When fetching data in a Server Component, prefer async and await over use. async and await pick up rendering from the point where await was invoked, whereas use re-renders the component after the data is resolved.
```

ğŸ¶ Transforme le RSC en composant `async` pour pouvoir appeler `fetch` directement.

Fichiers

- `exercise/about/page`

### 3. ğŸš€ Appeler directement la base de donnÃ©es

Pourquoi exposer une API REST faisant un appel Ã  une base de donnÃ©es pour Ãªtre consommÃ©e par un composant via `fetch` ?

Alors que grÃ¢ce au RSC, on peut directement appeler la base de donnÃ©es ?

ğŸ¶ Dans cet exercice, supprime les appels `fetch` et appelle directement la base de donnÃ©es via la fonction `getPosts`.

```tsx
import {getPosts} from '@/db/sgbd'
```

## Aller plus loin

ğŸ“‘ Le lien vers la doc [https://react.dev/reference/rsc/server-components](https://react.dev/reference/rsc/server-components)

## Ils vont tâ€™aider

- **ğŸ¶ Mowgli le Chien** : _Mowgli te guidera dans chaque exercice._
- **ğŸ¤– Ash le Robot** : _Ash le Robot te donnera du code utile._
- **ğŸš€ Julia La roquette** : _Julia te donnera des dÃ©fis supplÃ©mentaires._
- **â›ï¸ Hulk le Marteau** : _Quand du code Ã  supprimer est prÃ©sent_
- **ğŸ‘¨â€âœˆï¸ Hugo le chef de projet** : _Va t'aider sur les spÃ©cifications du projet_

## ğŸœ Feedback

Remplir le formulaire le [formulaire de FeedBack](https://go.mikecodeur.com/cours-next-avis?entry.1912869708=Next%20PRO&entry.1430994900=03.RSC%20Data%20fetch&entry.533578441=04%20Fetch%20RSC).
